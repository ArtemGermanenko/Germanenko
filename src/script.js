var photoPosts = [{
        id: '1',
        description: 'aaaaaaaaaaaaaaaaa',
        createdAt: new Date('2017-02-23T23:00:00'),
        author: 'Artem Germanenko',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },

    {
        id: '2',
        description: 'bbbbbbbbbbbbbbbbbb',
        createdAt: new Date('2018-02-23T23:00:00'),
        author: 'Andry Ginzburg',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: 1,
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '3',
        description: 'ccccccccccccccccccc',
        createdAt: new Date('2015-11-23T12:30:25'),
        author: 'Karabanova Ksu',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '4',
        description: 'ddddddddddddddddddd',
        createdAt: new Date('2010-10-23T11:11:10'),
        author: 'Karasik Simon',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '5',
        description: 'eeeeeeeeeeeeeeeeeee',
        createdAt: new Date('2011-11-11T11:00:00'),
        author: 'Kovalchuck Alex',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '6',
        description: 'ffffffffffffffffff',
        createdAt: new Date('2015-02-23T23:00:00'),
        author: 'Kozlovski Vlad',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '7',
        description: '',
        createdAt: new Date('2016-02-23T23:00:00'),
        author: 'Kovchugo Ksu',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
    },
    {
        id: '8',
        description: 'ggggggggggggggggggggg',
        createdAt: new Date('2012-02-23T23:00:00'),
        author: 'Kobzev Dmitry',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '9',
        description: 'hhhhhhhhhhhhhhhhhhhhhhhh',
        createdAt: new Date('2013-02-23T23:00:00'),
        author: 'Kukel Jenya',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
    },
    {
        id: '10',
        description: 'yyyyyyyyyyyyyyyyyyyyyyyyyy',
        createdAt: new Date('2016-02-23T23:00:00'),
        author: 'Kunc Ecaterina',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '11',
        description: 'tttttttttttttttttttttttttttt',
        createdAt: new Date('2010-02-23T23:00:00'),
        author: 'Lazaruonock Nickita',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '12',
        description: 'wwwwwwwwwwwwwwwwwwwwwwwwwww',
        createdAt: new Date('2000-02-23T23:00:00'),
        author: 'Malina Vlad',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '13',
        description: 'rrrrrrrrrrrrrrrrrrrrrrrrrrr',
        createdAt: new Date('2001-02-23T23:00:00'),
        author: 'Rudevich Arina',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '14',
        description: 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxx',
        createdAt: new Date('2002-02-23T23:00:00'),
        author: 'ROmashevsky Pavel',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '15',
        description: 'uuuuuuuuuuuuuuuuuuuuuuuuuuuuuu',
        createdAt: new Date('2018-02-23T23:00:00'),
        author: 'Sidirova Yana',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '16',
        description: 'kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk',
        createdAt: new Date('2017-02-23T23:00:00'),
        author: 'Shatrova Dasha',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
    },
    {
        id: '17',
        description: 'lllllllllllllllllllllllllllllllll',
        createdAt: new Date('2000-02-23T23:00:00'),
        author: 'Manzhulina Elizaveta',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '18',
        description: 'ooooooooooooooooooooooooooooooooo',
        createdAt: new Date('2009-02-23T23:00:00'),
        author: 'Serenckov Boris',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
    {
        id: '19',
        description: 'ppppppppppppppppppppppppppppppppppp',
        createdAt: new Date('2008-02-23T23:00:00'),
        author: 'Myxarski alex',
        photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
        hashTags: ['#NiceWorld', '#HelloWorld'],
        likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
    },
];


var photoPosttoAdd = {
    id: '20',
    description: 'zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz',
    createdAt: new Date('2007-02-23T23:00:00'),
    author: 'Shpuntov Ivan',
    photoLink: 'http://ont.by/webroot/delivery/files/news/2018/02/22/Dom.jpg',
    hashTags: ['#NiceWorld', '#HelloWorld'],
    likes: ['Artem Germanenko', 'Ksu Karabanova', 'Simon Karasik']
}


let main_module = (function() {
    function compare(PostOne, PostTwo) {
        return Date.parse(PostTwo.createdAt) - Date.parse(PostOne.createdAt);
    }

    photoPosts = photoPosts.sort(compare);

    return {
        getPhotoPosts: function(skip, top, filterConfig) {
            if (typeof skip !== 'number') {
                skip = 0;
            }

            if (typeof top !== 'number') {
                top = 10;
            }

            if (filterConfig) {
                let photoPostsToRemake = photoPosts;
                if (filterConfig.author)
                    photoPostsToRemake = photoPostsToRemake.filter(post => post.author === filterConfig.author);
                if (filterConfig.hashtags) {
                    photoFilterResult = photoFilterResult.filter(post => {
                        return filterConfig.hashTags.every((tag) => {
                            return post.hashTags.includes(tag);
                        });
                    });
                }

                if (filterConfig.createdAt) {
                    photoPostsToRemake = photoPostsToRemake.filter(post =>
                        post.createdAt.getFullYear() === filterConfig.createdAt.getFullYear() &&
                        post.createdAt.getMonth() === filterConfig.createdAt.getMonth() &&
                        post.createdAt.getDate() === filterConfig.createdAt.getDate());
                }

                return photoPostsToRemake.slice(skip, skip + top);
            }
            return photoPosts.slice(skip, skip + top);
        },

        getPhotoPost: function(ID) {
            return photoPosts.find(posts => posts.id === ID);
        },

        validatePhotoPost: function(photoPost) {
            if (typeof photoPost.description !== 'string') {
                return false;
            }
            if (photoPost.description.length === 0) {
                return false;
            }
            if (typeof photoPost.author !== 'string') {
                return false;
            }
            if (photoPost.author.length === 0) {
                return false;
            }
            if (typeof photoPost.id !== 'string') {
                return false;
            }
            if (photoPost.id.length === 0) {
                return false;
            }
            if (typeof photoPost.photoLink !== 'string') {
                return false;
            }
            if (photoPost.photoLink.length === 0) {
                return false;
            }
            if (!(photoPost.createdAt instanceof Date)) {
                return false;
            }
            if (!(photoPost.hashTags instanceof Array)) {
                return false;
            }
            if (!(photoPost.likes instanceof Array)) {
                return false;
            }
            return true;
        },

        addPhotoPost: function(photoPost) {
            if (!this.validatePhotoPost(photoPost) || photoPosts.findIndex(index => index.id === photoPost.id) !== -1) {
                return false;
            }
            photoPosts.push(photoPost);
            photoPosts.sort(compare);
            return true;
        },

        editPhotoPost: function(ID, photoPost) {
            let index = photoPosts.findIndex(post => post.id === ID);
            if (!this.validatePhotoPost(photoPosts[index])) {
                return false;
            }
            if (photoPost.author || photoPost.id || photoPost.createdAt || index === -1) {
                return false;
            }
            if (photoPost.description) {
                photoPosts[index].description = photoPost.description;
            }
            if (photoPost.photoLink) {
                photoPosts[index].photoLink = photoPost.photoLink;
            }
            if (photoPost.hashTags) {
                photoPosts[index].hashTags = photoPost.hashTags;
            }
            if (photoPost.likes) {
                photoPosts[index].likes = photoPost.likes;
            }
            return true;
        },

        removePhotoPost: function(ID) {
            if (photoPosts.findIndex(post => post.id == ID) !== -1) {
                photoPosts.splice(photoPosts.findIndex(post => post.id == ID), 1);
                return true;
            }
            return false;
        }
    }
})();

console.log('All posts:');
console.log(photoPosts);
console.log('Check getPhotoPosts');
console.log(main_module.getPhotoPosts(0, 10));
console.log(main_module.getPhotoPosts(10, 10));
console.log(main_module.getPhotoPosts(0, 10, {author: 'Artem Germanenko'}));
console.log(main_module.getPhotoPosts(0, 10, { hashTags: ['#NiceWorld', '#HelloWorld']}));
console.log(main_module.getPhotoPosts(0, 10, {author: 'Artem Germanenko', hashTags: ['#NiceWorld', '#HelloWorld']}));
console.log('Check getPhotoPost');
console.log(main_module.getPhotoPost('1'));
console.log(main_module.getPhotoPost('100'));
console.log('Check validatePhotoPost');
console.log(main_module.validatePhotoPost(main_module.getPhotoPost('1')));
console.log(main_module.validatePhotoPost(main_module.getPhotoPost('7')));
console.log('Check addPhotoPost');
console.log(main_module.addPhotoPost(photoPosttoAdd));
console.log(photoPosts);
console.log(main_module.addPhotoPost({description: 'bad args'}));
console.log('Check editPhotoPost');
console.log(main_module.editPhotoPost('1', {description: "hi my hero superman", likes: ['nobody']}));
console.log(main_module.editPhotoPost('1', {  author: 'bad args'}));
console.log(photoPosts);
console.log('Check removePhotoPost');
console.log(main_module.removePhotoPost('10'));
console.log(main_module.removePhotoPost('100'));
console.log(photoPosts);

